___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "GetCookies CMP",
  "description": "Cookie consent banner with full Google Consent Mode v2 support. GDPR, CCPA, and ePrivacy compliant.",
  "categories": [
    "TAG_MANAGEMENT",
    "PERSONALIZATION"
  ],
  "brand": {
    "id": "getcookies",
    "displayName": "GetCookies",
    "thumbnail": "data:image/png;base64,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93twEalsvrplZhMrfdXQm8EMYRADGMJQhtPAMGoZ9q61fNtZSgurWc5K3mFptH7QClZvWOVzO7Vq4OtctvLxSQ0XBzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzK47/D6O9M9GKDUIXAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDI2LTAxLTAzVDE3OjQxOjM3KzAwOjAwdAjOJwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyNS0xMi0yOVQxMjo1MjowMSswMDowMABaqdYAAAAodEVYdGRhdGU6dGltZXN0YW1wADIwMjYtMDEtMDNUMTg6MjY6MTQrMDA6MDAMlE6rAAAAAElFTkSuQmCC"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "domainId",
    "displayName": "Domain ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "REGEX",
        "args": [
          "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        ]
      },
      {
        "type": "NON_EMPTY"
      }
    ],
    "help": "Find your Domain ID in the GetCookies dashboard at https://getcookies.co under Domains â†’ Widget Configuration",
    "valueHint": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "notSetText": "Please enter your Domain ID from the GetCookies dashboard"
  },
  {
    "type": "CHECKBOX",
    "name": "consentModeEnabled",
    "checkboxText": "Enable Google Consent Mode v2",
    "simpleValueType": true,
    "defaultValue": true,
    "help": "Enable Consent Mode if one or more of your tags rely on Google\u0027s consent API. GetCookies will automatically signal the user\u0027s consent choices to Google tags (Analytics, Ads, etc.).",
    "alwaysInSummary": true
  },
  {
    "type": "GROUP",
    "name": "consentModeSettings",
    "displayName": "Consent Mode Settings",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "TEXT",
        "name": "waitForUpdate",
        "displayName": "Wait for update (milliseconds)",
        "simpleValueType": true,
        "defaultValue": 500,
        "valueValidators": [
          {
            "type": "NON_EMPTY"
          },
          {
            "type": "NON_NEGATIVE_NUMBER"
          }
        ],
        "help": "How long Google tags will wait for consent before firing in cookieless mode. Recommended: 500ms.",
        "valueUnit": "milliseconds"
      },
      {
        "type": "SELECT",
        "name": "adsDataRedaction",
        "displayName": "Redact ads data when consent denied",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "dynamic",
            "displayValue": "Dynamic (match ad_storage)"
          },
          {
            "value": true,
            "displayValue": "Always redact"
          },
          {
            "value": false,
            "displayValue": "Never redact"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "dynamic",
        "help": "When enabled and ad_storage consent is denied, ad click identifiers sent in network requests by Google Ads and Floodlight tags will be redacted."
      },
      {
        "type": "CHECKBOX",
        "name": "urlPassthrough",
        "checkboxText": "Enable URL passthrough",
        "simpleValueType": true,
        "defaultValue": true,
        "help": "When enabled, ad click information (gclid, dclid, etc.) will be passed through URL parameters across pages when cookies are denied, helping preserve conversion measurement."
      }
    ],
    "enablingConditions": [
      {
        "paramName": "consentModeEnabled",
        "paramValue": true,
        "type": "EQUALS"
      }
    ]
  },
  {
    "type": "GROUP",
    "name": "defaultConsentSettings",
    "displayName": "Default Consent State",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SELECT",
        "name": "defaultAnalytics",
        "displayName": "Analytics (analytics_storage)",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "help": "Default state for analytics cookies (Google Analytics, etc.)"
      },
      {
        "type": "SELECT",
        "name": "defaultAdStorage",
        "displayName": "Advertising (ad_storage)",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "help": "Default state for advertising cookies (Google Ads, Meta Pixel, etc.)"
      },
      {
        "type": "SELECT",
        "name": "defaultAdUserData",
        "displayName": "Ad User Data (ad_user_data)",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "help": "Default state for sending user data to Google for advertising purposes"
      },
      {
        "type": "SELECT",
        "name": "defaultAdPersonalization",
        "displayName": "Ad Personalization (ad_personalization)",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "help": "Default state for personalized advertising (remarketing)"
      },
      {
        "type": "SELECT",
        "name": "defaultFunctionality",
        "displayName": "Functionality (functionality_storage)",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "help": "Default state for functionality cookies (preferences, language settings)"
      },
      {
        "type": "SELECT",
        "name": "defaultPersonalization",
        "displayName": "Personalization (personalization_storage)",
        "macrosInSelect": false,
        "selectItems": [
          {
            "value": "denied",
            "displayValue": "Denied"
          },
          {
            "value": "granted",
            "displayValue": "Granted"
          }
        ],
        "simpleValueType": true,
        "defaultValue": "denied",
        "help": "Default state for personalization cookies (recommendations, content customization)"
      }
    ],
    "enablingConditions": [
      {
        "paramName": "consentModeEnabled",
        "paramValue": true,
        "type": "EQUALS"
      }
    ],
    "help": "Configure the default consent state before user interaction. For GDPR compliance, all should be set to \u0027Denied\u0027."
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const injectScript = require('injectScript');
const setDefaultConsentState = require('setDefaultConsentState');
const updateConsentState = require('updateConsentState');
const gtagSet = require('gtagSet');
const JSON = require('JSON');
const localStorage = require('localStorage');
const setInWindow = require('setInWindow');
const logToConsole = require('logToConsole');
const queryPermission = require('queryPermission');

// Configuration from template parameters
const domainId = data.domainId;
const consentModeEnabled = data.consentModeEnabled !== false;
const waitForUpdate = data.waitForUpdate || 500;
const urlPassthrough = data.urlPassthrough !== false;
const adsDataRedaction = data.adsDataRedaction || 'dynamic';

// Default consent values from settings
const defaultAnalytics = data.defaultAnalytics || 'denied';
const defaultAdStorage = data.defaultAdStorage || 'denied';
const defaultAdUserData = data.defaultAdUserData || 'denied';
const defaultAdPersonalization = data.defaultAdPersonalization || 'denied';
const defaultFunctionality = data.defaultFunctionality || 'denied';
const defaultPersonalization = data.defaultPersonalization || 'denied';

// Storage key for consent (must match GetCookies widget)
const CONSENT_KEY = 'getcookies_consent';

// Set up Google Consent Mode v2
if (consentModeEnabled) {
  // Set URL passthrough and developer ID
  gtagSet({
    'url_passthrough': urlPassthrough,
    'developer_id.dODAxZj': true
  });

  // Set default consent state (before any tags fire)
  const defaultConsent = {
    ad_storage: defaultAdStorage,
    ad_user_data: defaultAdUserData,
    ad_personalization: defaultAdPersonalization,
    analytics_storage: defaultAnalytics,
    functionality_storage: defaultFunctionality,
    personalization_storage: defaultPersonalization,
    security_storage: 'granted',
    wait_for_update: waitForUpdate
  };

  setDefaultConsentState(defaultConsent);
  logToConsole('GetCookies: Default consent state set', defaultConsent);

  // Check for existing consent in localStorage
  if (queryPermission('access_local_storage', 'read', CONSENT_KEY)) {
    const storedConsent = localStorage.getItem(CONSENT_KEY);

    if (storedConsent) {
      const parsed = JSON.parse(storedConsent);

      if (parsed && parsed.categories) {
        const categories = parsed.categories;
        const hasAnalytics = categories.indexOf('analytics') > -1;
        const hasMarketing = categories.indexOf('marketing') > -1 || categories.indexOf('advertising') > -1;
        const hasPreferences = categories.indexOf('preferences') > -1 || categories.indexOf('functional') > -1;

        const consentUpdate = {
          ad_storage: hasMarketing ? 'granted' : 'denied',
          ad_user_data: hasMarketing ? 'granted' : 'denied',
          ad_personalization: hasMarketing ? 'granted' : 'denied',
          analytics_storage: hasAnalytics ? 'granted' : 'denied',
          functionality_storage: hasPreferences ? 'granted' : 'denied',
          personalization_storage: hasPreferences ? 'granted' : 'denied',
          security_storage: 'granted'
        };

        updateConsentState(consentUpdate);
        logToConsole('GetCookies: Restored consent from storage', consentUpdate);

        // Set ads data redaction based on marketing consent
        const redactionValue = adsDataRedaction === 'dynamic' ? !hasMarketing : adsDataRedaction === true;
        gtagSet({ 'ads_data_redaction': redactionValue });
      }
    } else {
      // No stored consent - set initial ads data redaction (denied state)
      const redactionValue = adsDataRedaction === 'dynamic' ? true : adsDataRedaction === true;
      gtagSet({ 'ads_data_redaction': redactionValue });
    }
  }
}

// Set up listener for consent updates from GetCookies widget
setInWindow('__GetCookiesGTM', {
  updateConsent: function(choices) {
    if (!consentModeEnabled) return;

    const consentUpdate = {
      ad_storage: choices.marketing ? 'granted' : 'denied',
      ad_user_data: choices.marketing ? 'granted' : 'denied',
      ad_personalization: choices.marketing ? 'granted' : 'denied',
      analytics_storage: choices.analytics ? 'granted' : 'denied',
      functionality_storage: choices.preferences ? 'granted' : 'denied',
      personalization_storage: choices.preferences ? 'granted' : 'denied',
      security_storage: 'granted'
    };

    updateConsentState(consentUpdate);

    // Update ads data redaction
    const marketingGranted = choices.marketing === true;
    const redactionValue = adsDataRedaction === 'dynamic' ? !marketingGranted : adsDataRedaction === true;
    gtagSet({ 'ads_data_redaction': redactionValue });

    logToConsole('GetCookies: Consent updated by user', consentUpdate);
  }
}, true);

// Set domain ID as global variable so widget.js can read it
setInWindow('__GETCOOKIES_DOMAIN_ID', domainId, true);

// Build the loader script URL with domain ID
const scriptUrl = 'https://api.getcookies.co/api/v1/widget/loader.js?id=' + domainId;

// Inject the GetCookies widget script
injectScript(scriptUrl, function() {
  logToConsole('GetCookies: Widget loaded successfully for domain ' + domainId);
  data.gtmOnSuccess();
}, function() {
  logToConsole('GetCookies: Failed to load widget script');
  data.gtmOnFailure();
}, 'getcookies-widget');


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://getcookies.co/*"
              },
              {
                "type": 1,
                "string": "https://api.getcookies.co/*"
              },
              {
                "type": 1,
                "string": "https://getcookies.co/static/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_consent",
        "versionId": "1"
      },
      "param": [
        {
          "key": "consentTypes",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_user_data"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "ad_personalization"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "analytics_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "functionality_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "personalization_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "consentType"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "security_storage"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_local_storage",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "getcookies_consent"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "write_data_layer",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keyPatterns",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "ads_data_redaction"
              },
              {
                "type": 1,
                "string": "url_passthrough"
              },
              {
                "type": 1,
                "string": "developer_id.dODAxZj"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "__GetCookiesGTM"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "__GETCOOKIES_DOMAIN_ID"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Sets default consent state when consent mode enabled
  code: |-
    const mockData = {
      domainId: '12345678-1234-1234-1234-123456789012',
      consentModeEnabled: true,
      waitForUpdate: 500,
      urlPassthrough: true,
      adsDataRedaction: 'dynamic',
      defaultAnalytics: 'denied',
      defaultAdStorage: 'denied',
      defaultAdUserData: 'denied',
      defaultAdPersonalization: 'denied',
      defaultFunctionality: 'denied',
      defaultPersonalization: 'denied'
    };

    mock('setDefaultConsentState', function(consent) {
      assertThat(consent.ad_storage).isEqualTo('denied');
      assertThat(consent.analytics_storage).isEqualTo('denied');
      assertThat(consent.wait_for_update).isEqualTo(500);
    });

    mock('gtagSet', function() {});
    mock('localStorage', { getItem: function() { return null; } });
    mock('setInWindow', function() {});
    mock('injectScript', function(url, onSuccess) { onSuccess(); });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();

- name: Restores consent from localStorage
  code: |-
    const mockData = {
      domainId: '12345678-1234-1234-1234-123456789012',
      consentModeEnabled: true,
      waitForUpdate: 500,
      adsDataRedaction: 'dynamic'
    };

    const storedConsent = JSON.stringify({
      categories: ['necessary', 'analytics', 'marketing']
    });

    mock('setDefaultConsentState', function() {});
    mock('updateConsentState', function(consent) {
      assertThat(consent.analytics_storage).isEqualTo('granted');
      assertThat(consent.ad_storage).isEqualTo('granted');
    });
    mock('gtagSet', function() {});
    mock('localStorage', { getItem: function() { return storedConsent; } });
    mock('queryPermission', function() { return true; });
    mock('setInWindow', function() {});
    mock('injectScript', function(url, onSuccess) { onSuccess(); });

    runCode(mockData);

    assertApi('gtmOnSuccess').wasCalled();


___NOTES___

GetCookies CMP - Google Tag Manager Template
Version 1.0.0

Features:
- Full Google Consent Mode v2 support
- Sets default consent state BEFORE any tags fire
- Reads existing consent from localStorage
- Real-time consent updates when user interacts with banner
- Supports all consent types: ad_storage, ad_user_data, ad_personalization, analytics_storage, functionality_storage, personalization_storage
- URL passthrough for conversion measurement when cookies denied
- Ads data redaction option

For documentation, visit: https://getcookies.co/help/gtm-installation
For support, visit: https://getcookies.co/support

Copyright 2024 GetCookies
Licensed under Apache License 2.0
